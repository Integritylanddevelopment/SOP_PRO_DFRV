<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Douglas Forest RV Resort - Employee Management System</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Open+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            body {
                padding: 5px;
            }

            .header {
                padding: 20px;
            }

            .employee-form {
                grid-template-columns: 1fr;
            }

            .name-input-group {
                grid-template-columns: 1fr;
            }

            .sop-accordion {
                margin-bottom: 20px;
            }

            .sop-header {
                padding: 15px;
            }

            .sop-header h3 {
                font-size: 1em;
            }

            .sop-body {
                padding: 20px;
            }

            .checklist-item {
                padding: 15px;
                margin-bottom: 12px;
            }

            .checklist-item input[type="checkbox"] {
                transform: scale(1.2);
                margin-right: 12px;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }

            .stat-card {
                padding: 15px;
            }

            .stat-number {
                font-size: 1.5em;
            }

            .mini-controls {
                flex-direction: column;
                align-items: center;
            }

            .btn {
                min-width: 120px;
                margin: 5px 0;
            }

            .item-timestamp {
                position: static;
                margin-top: 8px;
                display: block;
            }
        }

        body {
            font-family: 'Montserrat', 'Arial Black', sans-serif;
            line-height: 1.6;
            color: #2c3e50;
            background: #2C5530;
            min-height: 100vh;
            padding: 10px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0;
        }

        /* Header */
        /* Update all colors to match Douglas Forest branding */
        .header {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            border: 3px solid #7CB342;
        }

        .nav-tab.active {
            background: linear-gradient(135deg, #7CB342, #689F38);
            color: white;
            box-shadow: 0 5px 15px rgba(124, 179, 66, 0.3);
        }

        .employee-info, .onboarding-wizard, .handbook-section, .completion-summary {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 3px solid #7CB342;
        }

        .btn-primary {
            background: linear-gradient(135deg, #7CB342, #689F38);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #8BC34A, #7CB342);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(124, 179, 66, 0.3);
        }

        .sop-accordion {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 35px rgba(0, 0, 0, 0.15);
            border: 3px solid #7CB342;
            margin-bottom: 25px;
        }

        .sop-header {
            background: linear-gradient(135deg, #7CB342, #689F38);
            color: white;
            padding: 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-section {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .douglas-forest-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
        }

        .logo-container {
            background: linear-gradient(145deg, #2D4A1F, #3A5D2A);
            padding: 25px 30px;
            border-radius: 15px;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.4), inset 0 3px 15px rgba(255, 255, 255, 0.1);
            border: 3px solid #1F3216;
        }

        .logo-inner {
            background: linear-gradient(145deg, #9CCC65, #8BC34A);
            padding: 20px 25px;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            box-shadow: inset 0 3px 12px rgba(0, 0, 0, 0.2), 0 2px 8px rgba(255, 255, 255, 0.2);
            position: relative;
            border: 1px solid #7CB342;
        }

        .logo-p {
            font-size: 4em;
            font-weight: 900;
            color: #1B2A0F;
            font-family: 'Montserrat', sans-serif;
            line-height: 0.7;
            margin: -8px 0 5px 0;
            text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.4);
            filter: drop-shadow(1px 1px 2px rgba(0, 0, 0, 0.2));
        }

        .douglas-text, .forest-text {
            font-size: 1.6em;
            font-weight: 900;
            color: #1B2A0F;
            font-family: 'Montserrat', sans-serif;
            line-height: 0.85;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.4);
            filter: drop-shadow(1px 1px 2px rgba(0, 0, 0, 0.2));
        }

        .douglas-text {
            margin: 0 0 -3px 0;
        }

        .forest-text {
            margin: -3px 0 8px 0;
        }

        .rv-text {
            font-size: 0.95em;
            font-weight: 700;
            color: #1B2A0F;
            letter-spacing: 3px;
            text-align: center;
            font-family: 'Montserrat', sans-serif;
            text-transform: uppercase;
            text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.4);
            filter: drop-shadow(1px 1px 2px rgba(0, 0, 0, 0.2));
        }

        .header-info {
            flex: 1;
        }

        .logo-section {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .header-info h1 {
            color: #006400;
            font-size: 2.2em;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #228B22, #006400);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 800;
        }

        .header-info .subtitle {
            color: #2F4F4F;
            font-size: 1.2em;
            font-weight: 600;
        }
        /* Watermark logos throughout the app */
        .douglas-watermark {
            position: fixed;
            bottom: 20px;
            right: 20px;
            opacity: 0.1;
            pointer-events: none;
            z-index: -1;
        }

        .douglas-watermark .watermark-pine {
            font-size: 8em;
            color: #228B22;
        }

        .douglas-watermark .watermark-text {
            text-align: center;
            font-size: 1.2em;
            font-weight: 900;
            color: #006400;
            letter-spacing: 2px;
            margin-top: -20px;
        }

        /* SOP headers with Douglas Forest branding */
        .sop-header h3::before {
            content: "üå≤ ";
            margin-right: 8px;
        }

        /* Signature sections with Douglas Forest logo */
        .signature-section::before {
            content: "";
            display: block;
            text-align: center;
            margin-bottom: 15px;
            font-size: 2em;
        }

        .sop-signature-section::before {
            content: "üå≤ DOUGLAS FOREST RV RESORT üå≤";
            display: block;
            text-align: center;
            margin-bottom: 15px;
            font-size: 0.9em;
            font-weight: bold;
            color: #228B22;
            letter-spacing: 1px;
        }
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 15px;
        }

        .section-logo .mini-pine {
            font-size: 1.5em;
            color: #228B22;
        }

        .section-logo .mini-text {
            font-size: 1.1em;
            font-weight: 700;
            color: #006400;
            letter-spacing: 1px;
        }

        /* Update section headers to include mini logos */
        .employee-info h3, .onboarding-wizard h2, .handbook-section h2, .handbook-section h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            justify-content: center;
        }

        .employee-info h3::before, .onboarding-wizard h2::before, .handbook-section h2::before {
            content: "üå≤";
            font-size: 1.2em;
            color: #228B22;
        }

        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 10px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            overflow-x: auto;
        }

        .nav-tab {
            flex: 1;
            padding: 15px 20px;
            text-align: center;
            background: transparent;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            color: #7f8c8d;
            white-space: nowrap;
        }

        .nav-tab.active {
            background: linear-gradient(135deg, #228B22, #006400);
            color: white;
            box-shadow: 0 5px 15px rgba(34, 139, 34, 0.3);
        }

        /* Employee Form and other sections */
        .employee-info, .onboarding-wizard, .handbook-section {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 3px solid #228B22;
        }

        .form-group label {
            color: #228B22;
            font-weight: 600;
        }

        .form-group input:focus, .form-group select:focus {
            border-color: #228B22;
            box-shadow: 0 0 0 3px rgba(34, 139, 34, 0.1);
        }

        .nav-tab:hover:not(.active) {
            background: #ecf0f1;
            color: #2c3e50;
        }

        /* Tab Content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Onboarding Wizard */
        .onboarding-wizard {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            border: 3px solid #27ae60;
        }

        .wizard-step {
            display: none;
        }

        .wizard-step.active {
            display: block;
        }

        .step-indicator {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
        }

        .step {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #bdc3c7;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 10px;
            font-weight: bold;
            position: relative;
        }

        .step.active {
            background: linear-gradient(135deg, #228B22, #006400);
        }

        .step.completed {
            background: #32CD32;
        }

        .form-group label {
            position: absolute;
            top: -10px;
            left: 15px;
            background: white;
            padding: 0 8px;
            font-size: 0.9em;
            color: #228B22;
            font-weight: 600;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #228B22;
            box-shadow: 0 0 0 3px rgba(34, 139, 34, 0.1);
        }

        .photo-preview {
            border: 5px solid #228B22;
        }

        .step::after {
            content: '';
            position: absolute;
            right: -20px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 2px;
            background: #bdc3c7;
        }

        .step:last-child::after {
            display: none;
        }

        /* Employee Form */
        .employee-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .form-group {
            position: relative;
        }

        .form-group label {
            position: absolute;
            top: -10px;
            left: 15px;
            background: white;
            padding: 0 8px;
            font-size: 0.9em;
            color: #27ae60;
            font-weight: 600;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #bdc3c7;
            border-radius: 12px;
            font-size: 1em;
            transition: all 0.3s ease;
            background: white;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #27ae60;
            box-shadow: 0 0 0 3px rgba(39, 174, 96, 0.1);
        }

        /* Photo Capture */
        .photo-capture {
            text-align: center;
            padding: 30px;
            background: #f8f9ff;
            border-radius: 15px;
            margin: 20px 0;
        }

        .photo-preview {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            border: 5px solid #27ae60;
            object-fit: cover;
            margin: 0 auto 20px;
            display: block;
            background: #ecf0f1;
        }

        .photo-placeholder {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            border: 3px dashed #bdc3c7;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 3em;
            color: #bdc3c7;
            background: white;
        }

        /* Handbook Policies */
        .handbook-section {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 3px solid #27ae60;
        }

        .policy-item {
            background: #f8fff8;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 5px solid #228B22;
        }

        .policy-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #006400;
            margin-bottom: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #228B22, #006400);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #32CD32, #228B22);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(34, 139, 34, 0.3);
        }

        .policy-content {
            color: #34495e;
            line-height: 1.7;
        }

        /* Signature Section */
        .signature-section {
            background: #f0f8ff;
            border-radius: 15px;
            padding: 25px;
            margin-top: 25px;
            border: 2px solid #3498db;
        }

        .signature-canvas {
            border: 2px solid #bdc3c7;
            border-radius: 10px;
            width: 100%;
            height: 150px;
            cursor: crosshair;
            background: white;
            margin: 15px 0;
        }

        /* Buttons */
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #228B22, #006400);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #32CD32, #228B22);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(34, 139, 34, 0.3);
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
            transform: translateY(-2px);
        }

        .btn-danger {
            background: #e74c3c;
            color: white;
        }

        .btn-emergency {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            font-size: 1.1em;
            padding: 15px 30px;
            animation: emergencyPulse 2s infinite;
        }

        @keyframes emergencyPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0.4); }
            50% { box-shadow: 0 0 0 10px rgba(231, 76, 60, 0); }
        }

        /* SOP Sections */
        .sop-locked {
            opacity: 0.5;
            pointer-events: none;
            position: relative;
        }

        .sop-locked::before {
            content: 'üîí Complete Employee Handbook First';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(231, 76, 60, 0.9);
            color: white;
            padding: 20px;
            border-radius: 10px;
            font-weight: bold;
            z-index: 10;
        }

        .sop-accordion {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 35px rgba(0, 0, 0, 0.15);
            border: 3px solid #228B22;
            margin-bottom: 25px;
        }

        .sop-accordion:hover {
            border-color: #228B22;
        }

        .sop-header {
            background: linear-gradient(135deg, #228B22, #006400);
            color: white;
            padding: 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .sop-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease;
            background: white;
        }

        .sop-content.active {
            max-height: 5000px;
        }

        .sop-body {
            padding: 25px;
        }

        /* Incident Reporting */
        .incident-media {
            background: #f8f9ff;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }

        .media-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .media-preview {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .media-item {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            aspect-ratio: 1;
        }

        .media-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .media-item .remove-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(231, 76, 60, 0.8);
            color: white;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            cursor: pointer;
            font-size: 0.8em;
        }

        /* Emergency Contacts */
        .emergency-contacts {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .emergency-contact {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .emergency-contact:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(231, 76, 60, 0.4);
        }

        /* Status Indicators */
        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-approved {
            background: #d4edda;
            color: #155724;
        }

        .status-rejected {
            background: #f8d7da;
            color: #721c24;
        }

        /* Manager Dashboard */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .dashboard-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 2px solid #ecf0f1;
        }

        .employee-card {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: #f8f9ff;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        .employee-photo {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #228B22;
        }

        .status-approved {
            background: #d4f4dd;
            color: #0f5132;
        }

        .completion-status {
            text-align: center;
            margin: 15px 0;
            font-weight: bold;
            color: #228B22;
            font-size: 1.1em;
        }

        .onboarding-wizard h2 {
            color: #006400;
        }

        .signature-section h4 {
            color: #006400;
        }

        .incident-media h4 {
            color: #006400;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            body {
                padding: 5px;
            }

            .header {
                padding: 20px;
            }

            .header h1 {
                font-size: 1.8em;
            }

            .logo {
                width: 60px;
                height: 60px;
                font-size: 1.5em;
            }

            .employee-form {
                grid-template-columns: 1fr;
            }

            .nav-tabs {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            .nav-tab {
                min-width: 120px;
            }

            .media-controls {
                grid-template-columns: 1fr;
            }

            .emergency-contacts {
                grid-template-columns: 1fr;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Hidden elements */
        .hidden {
            display: none !important;
        }

        /* Loading states */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #228B22;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        /* Update some additional colors */
        .timestamp-badge {
            color: #228B22;
            background: rgba(34, 139, 34, 0.1);
        }

        .item-timestamp {
            color: #228B22;
            background: rgba(34, 139, 34, 0.1);
        }

        .checklist-item {
            border-left: 5px solid #228B22;
        }

        .checklist-item input[type="checkbox"] {
            accent-color: #228B22;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Douglas Forest Watermark -->
        <div class="douglas-watermark">
            <div class="watermark-pine">üå≤</div>
            <div class="watermark-text">
                DOUGLAS<br>FOREST
            </div>
        </div>
        <div class="header">
            <div class="logo-section">
                <div class="douglas-forest-logo">
                    <div class="logo-container">
                        <div class="logo-inner">
                            <div class="logo-p">P</div>
                            <div class="douglas-text">DOUGLAS</div>
                            <div class="forest-text">FOREST</div>
                            <div class="rv-text">RV RESORT</div>
                        </div>
                    </div>
                </div>
                <div class="header-info">
                    <h1>Employee Management System</h1>
                    <div class="subtitle">Douglas Forest RV Resort LLC</div>
                    <div style="color: #7f8c8d; font-size: 1em; margin-top: 5px;">106 Douglas Road, Webster, MA 01570</div>
                    <div style="color: #7f8c8d; font-size: 0.9em;">üìû (508) 943-4440 | üåê douglasforestrv.com</div>
                </div>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="switchTab('employee')">üë§ Employee Portal</button>
            <button class="nav-tab" onclick="switchTab('manager')">üëî Manager Dashboard</button>
            <button class="nav-tab" onclick="switchTab('owner')" ondblclick="ownerBypass()">üè¢ Owner Dashboard</button>
        </div>

        <!-- Employee Portal Tab -->
        <div id="employee-tab" class="tab-content active">
            <!-- Onboarding Wizard -->
            <div class="onboarding-wizard" id="onboarding-wizard">
                <div class="step-indicator">
                    <div class="step active" id="step-1">1</div>
                    <div class="step" id="step-2">2</div>
                    <div class="step" id="step-3">3</div>
                    <div class="step" id="step-4">4</div>
                </div>

                <!-- Step 1: Employee Information -->
                <div class="wizard-step active" id="wizard-step-1">
                    <h2 style="text-align: center; color: #7CB342; margin-bottom: 30px;">üìù Employee Information</h2>
                    <div class="employee-form">
                        <div class="form-group">
                            <label>Full Name *</label>
                            <input type="text" id="employeeName" required>
                        </div>
                        <div class="form-group">
                            <label>Employee ID *</label>
                            <input type="text" id="employeeId" required>
                        </div>
                        <div class="form-group">
                            <label>Email Address *</label>
                            <input type="email" id="employeeEmail" required>
                        </div>
                        <div class="form-group">
                            <label>Phone Number *</label>
                            <input type="tel" id="employeePhone" required>
                        </div>
                        <div class="form-group">
                            <label>Position *</label>
                            <select id="employeePosition" required>
                                <option value="">Select Position</option>
                                <option value="front-desk">Front Desk</option>
                                <option value="maintenance">Maintenance</option>
                                <option value="housekeeping">Housekeeping</option>
                                <option value="security">Security</option>
                                <option value="activities">Activities Coordinator</option>
                                <option value="management">Management</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Start Date *</label>
                            <input type="date" id="startDate" required>
                        </div>
                        <div class="form-group">
                            <label>Supervisor</label>
                            <input type="text" id="supervisorName">
                        </div>
                        <div class="form-group">
                            <label>Emergency Contact</label>
                            <input type="text" id="emergencyContact" placeholder="Name and phone number">
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 30px;">
                        <button class="btn btn-primary" onclick="nextStep(2)">Next: Take Photo üì∏</button>
                    </div>
                </div>

                <!-- Step 2: Photo Capture -->
                <div class="wizard-step" id="wizard-step-2">
                    <h2 style="text-align: center; color: #7CB342; margin-bottom: 30px;">üì∏ Employee Photo</h2>
                    <div class="photo-capture">
                        <div class="photo-placeholder" id="photo-placeholder">üì∑</div>
                        <img class="photo-preview hidden" id="photo-preview" alt="Employee Photo">
                        <video id="video" class="hidden" width="200" height="200" autoplay></video>
                        <div style="margin-top: 20px;">
                            <button class="btn btn-primary" onclick="demoTakeEmployeePhoto()">üì∑ Take Photo</button>
                            <button class="btn btn-secondary" onclick="uploadPhoto()">üìÅ Upload Photo</button>
                            <input type="file" id="file-input" accept="image/*" class="hidden" onchange="handleFileSelect(event)">
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 30px;">
                        <button class="btn btn-secondary" onclick="previousStep(1)">‚Üê Previous</button>
                        <button class="btn btn-primary" onclick="nextStep(3)" id="photo-next-btn" disabled>Next: Read Handbook üìö</button>
                    </div>
                </div>

                <!-- Step 3: Employee Handbook -->
                <div class="wizard-step" id="wizard-step-3">
                    <h2 style="text-align: center; color: #7CB342; margin-bottom: 30px;">üìö Employee Handbook & Policies</h2>
                    <div class="handbook-section">
                        <div class="policy-item">
                            <div class="policy-title">1. Code of Conduct</div>
                            <div class="policy-content">
                                All employees must maintain professional behavior, treat guests and colleagues with respect, and uphold the values of Douglas Forest RV Resort. Inappropriate conduct, harassment, or discrimination will not be tolerated.
                            </div>
                        </div>

                        <div class="policy-item">
                            <div class="policy-title">2. Safety Protocols</div>
                            <div class="policy-content">
                                Employee safety is our top priority. All safety procedures must be followed strictly. Report any hazards immediately to management. Personal protective equipment must be worn when required.
                            </div>
                        </div>

                        <div class="policy-item">
                            <div class="policy-title">3. Guest Service Standards</div>
                            <div class="policy-content">
                                Provide exceptional service to all guests. Be courteous, helpful, and professional. Address complaints promptly and escalate issues to management when necessary. Guest satisfaction is paramount.
                            </div>
                        </div>

                        <div class="policy-item">
                            <div class="policy-title">4. Confidentiality</div>
                            <div class="policy-content">
                                Maintain strict confidentiality regarding guest information, company operations, and employee matters. Do not share sensitive information with unauthorized persons.
                            </div>
                        </div>

                        <div class="policy-item">
                            <div class="policy-title">5. Attendance & Punctuality</div>
                            <div class="policy-content">
                                Regular attendance and punctuality are essential. Notify your supervisor immediately if you cannot report to work. Excessive absences or tardiness may result in disciplinary action.
                            </div>
                        </div>

                        <div class="policy-item">
                            <div class="policy-title">6. Technology Use</div>
                            <div class="policy-content">
                                Company technology and equipment must be used responsibly and only for work-related purposes. Personal use should be minimal and not interfere with work duties.
                            </div>
                        </div>

                        <div class="policy-item">
                            <div class="policy-title">7. Incident Reporting</div>
                            <div class="policy-content">
                                All incidents, accidents, or unusual occurrences must be reported immediately to management. Complete incident reports thoroughly and honestly. Follow all Standard Operating Procedures (SOPs).
                            </div>
                        </div>
                    </div>

                    <div style="text-align: center; margin-top: 30px;">
                        <label style="display: flex; align-items: center; justify-content: center; gap: 10px; margin-bottom: 20px;">
                            <input type="checkbox" id="handbook-acknowledgment" onchange="toggleHandbookNext()">
                            <span>I have read and understand all policies in the Employee Handbook</span>
                        </label>
                        <button class="btn btn-secondary" onclick="previousStep(2)">‚Üê Previous</button>
                        <button class="btn btn-primary" onclick="nextStep(4)" id="handbook-next-btn" disabled>Next: Sign Agreement ‚úçÔ∏è</button>
                    </div>
                </div>

                <!-- Step 4: Signature & Completion -->
                <div class="wizard-step" id="wizard-step-4">
                    <h2 style="text-align: center; color: #7CB342; margin-bottom: 30px;">‚úçÔ∏è Employee Agreement Signature</h2>
                    <div class="signature-section">
                        <p style="text-align: center; margin-bottom: 20px; font-size: 1.1em;">
                            By signing below, I acknowledge that I have read, understood, and agree to comply with all policies and procedures outlined in the Employee Handbook.
                        </p>
                        <canvas id="handbook-signature" class="signature-canvas"></canvas>
                        <div style="text-align: center; margin-top: 15px;">
                            <button class="btn btn-secondary" onclick="clearSignature('handbook-signature')">Clear Signature</button>
                        </div>
                        <div id="signature-timestamp" class="timestamp" style="text-align: center; margin-top: 15px; color: #7f8c8d;"></div>
                    </div>

                    <div style="text-align: center; margin-top: 30px;">
                        <button class="btn btn-secondary" onclick="previousStep(3)">‚Üê Previous</button>
                        <button class="btn btn-primary" onclick="completeOnboarding()" id="complete-onboarding-btn">üéâ Complete Onboarding</button>
                    </div>
                </div>
            </div>

            <!-- Employee Status -->
            <div class="handbook-section hidden" id="employee-status">
                <h3 style="text-align: center; color: #7CB342; margin-bottom: 20px;">üìã Employment Status</h3>
                <div style="text-align: center;">
                    <div class="status-indicator status-pending" id="status-display">
                        ‚è≥ Awaiting Manager Approval
                    </div>
                    <p style="margin-top: 15px; color: #7f8c8d;">
                        Your onboarding submission is being reviewed by management. You will receive access to SOPs once approved.
                    </p>
                </div>
            </div>
            <!-- Onboarding Wizard -->
            <div class="onboarding-wizard" id="onboarding-wizard">
                <div class="step-indicator">
                    <div class="step active" id="step-1">1</div>
                    <div class="step" id="step-2">2</div>
                    <div class="step" id="step-3">3</div>
                    <div class="step" id="step-4">4</div>
                </div>

                <!-- Step 1: Employee Information -->
                <div class="wizard-step active" id="wizard-step-1">
                    <h2 style="text-align: center; color: #2e7d32; margin-bottom: 30px;">üìù Employee Information</h2>
                    <div class="employee-form">
                        <div class="form-group">
                            <label>Full Name *</label>
                            <input type="text" id="employeeName" required>
                        </div>
                        <div class="form-group">
                            <label>Employee ID *</label>
                            <input type="text" id="employeeId" required>
                        </div>
                        <div class="form-group">
                            <label>Email Address *</label>
                            <input type="email" id="employeeEmail" required>
                        </div>
                        <div class="form-group">
                            <label>Phone Number *</label>
                            <input type="tel" id="employeePhone" required>
                        </div>
                        <div class="form-group">
                            <label>Position *</label>
                            <select id="employeePosition" required>
                                <option value="">Select Position</option>
                                <option value="front-desk">Front Desk</option>
                                <option value="maintenance">Maintenance</option>
                                <option value="housekeeping">Housekeeping</option>
                                <option value="security">Security</option>
                                <option value="activities">Activities Coordinator</option>
                                <option value="management">Management</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Start Date *</label>
                            <input type="date" id="startDate" required>
                        </div>
                        <div class="form-group">
                            <label>Supervisor</label>
                            <input type="text" id="supervisorName">
                        </div>
                        <div class="form-group">
                            <label>Emergency Contact</label>
                            <input type="text" id="emergencyContact" placeholder="Name and phone number">
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 30px;">
                        <button class="btn btn-primary" onclick="nextStep(2)">Next: Take Photo üì∏</button>
                    </div>
                </div>

                <!-- Step 2: Photo Capture -->
                <div class="wizard-step" id="wizard-step-2">
                    <h2 style="text-align: center; color: #2e7d32; margin-bottom: 30px;">üì∏ Employee Photo</h2>
                    <div class="photo-capture">
                        <div class="photo-placeholder" id="photo-placeholder">üì∑</div>
                        <img class="photo-preview hidden" id="photo-preview" alt="Employee Photo">
                        <video id="video" class="hidden" width="200" height="200" autoplay></video>
                        <div style="margin-top: 20px;">
                            <button class="btn btn-primary" onclick="startCamera()">üì∑ Start Camera</button>
                            <button class="btn btn-secondary hidden" id="capture-btn" onclick="capturePhoto()">üì∏ Take Photo</button>
                            <button class="btn btn-secondary" onclick="uploadPhoto()">üìÅ Upload Photo</button>
                            <input type="file" id="file-input" accept="image/*" class="hidden" onchange="handleFileSelect(event)">
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 30px;">
                        <button class="btn btn-secondary" onclick="previousStep(1)">‚Üê Previous</button>
                        <button class="btn btn-primary" onclick="nextStep(3)" id="photo-next-btn" disabled>Next: Read Handbook üìö</button>
                    </div>
                </div>

                <!-- Step 3: Employee Handbook -->
                <div class="wizard-step" id="wizard-step-3">
                    <h2 style="text-align: center; color: #2e7d32; margin-bottom: 30px;">üìö Employee Handbook & Policies</h2>
                    <div class="handbook-section">
                        <div class="policy-item">
                            <div class="policy-title">1. Code of Conduct</div>
                            <div class="policy-content">
                                All employees must maintain professional behavior, treat guests and colleagues with respect, and uphold the values of Douglas Forest RV Resort. Inappropriate conduct, harassment, or discrimination will not be tolerated.
                            </div>
                        </div>

                        <div class="policy-item">
                            <div class="policy-title">2. Safety Protocols</div>
                            <div class="policy-content">
                                Employee safety is our top priority. All safety procedures must be followed strictly. Report any hazards immediately to management. Personal protective equipment must be worn when required.
                            </div>
                        </div>

                        <div class="policy-item">
                            <div class="policy-title">3. Guest Service Standards</div>
                            <div class="policy-content">
                                Provide exceptional service to all guests. Be courteous, helpful, and professional. Address complaints promptly and escalate issues to management when necessary. Guest satisfaction is paramount.
                            </div>
                        </div>

                        <div class="policy-item">
                            <div class="policy-title">4. Confidentiality</div>
                            <div class="policy-content">
                                Maintain strict confidentiality regarding guest information, company operations, and employee matters. Do not share sensitive information with unauthorized persons.
                            </div>
                        </div>

                        <div class="policy-item">
                            <div class="policy-title">5. Attendance & Punctuality</div>
                            <div class="policy-content">
                                Regular attendance and punctuality are essential. Notify your supervisor immediately if you cannot report to work. Excessive absences or tardiness may result in disciplinary action.
                            </div>
                        </div>

                        <div class="policy-item">
                            <div class="policy-title">6. Technology Use</div>
                            <div class="policy-content">
                                Company technology and equipment must be used responsibly and only for work-related purposes. Personal use should be minimal and not interfere with work duties.
                            </div>
                        </div>

                        <div class="policy-item">
                            <div class="policy-title">7. Incident Reporting</div>
                            <div class="policy-content">
                                All incidents, accidents, or unusual occurrences must be reported immediately to management. Complete incident reports thoroughly and honestly. Follow all Standard Operating Procedures (SOPs).
                            </div>
                        </div>
                    </div>

                    <div style="text-align: center; margin-top: 30px;">
                        <label style="display: flex; align-items: center; justify-content: center; gap: 10px; margin-bottom: 20px;">
                            <input type="checkbox" id="handbook-acknowledgment" onchange="toggleHandbookNext()">
                            <span>I have read and understand all policies in the Employee Handbook</span>
                        </label>
                        <button class="btn btn-secondary" onclick="previousStep(2)">‚Üê Previous</button>
                        <button class="btn btn-primary" onclick="nextStep(4)" id="handbook-next-btn" disabled>Next: Sign Agreement ‚úçÔ∏è</button>
                    </div>
                </div>

                <!-- Step 4: Signature & Completion -->
                <div class="wizard-step" id="wizard-step-4">
                    <h2 style="text-align: center; color: #2e7d32; margin-bottom: 30px;">‚úçÔ∏è Employee Agreement Signature</h2>
                    <div class="signature-section">
                        <p style="text-align: center; margin-bottom: 20px; font-size: 1.1em;">
                            By signing below, I acknowledge that I have read, understood, and agree to comply with all policies and procedures outlined in the Employee Handbook.
                        </p>
                        <canvas id="handbook-signature" class="signature-canvas"></canvas>
                        <div style="text-align: center; margin-top: 15px;">
                            <button class="btn btn-secondary" onclick="clearSignature('handbook-signature')">Clear Signature</button>
                        </div>
                        <div id="signature-timestamp" class="timestamp" style="text-align: center; margin-top: 15px; color: #7f8c8d;"></div>
                    </div>

                    <div style="text-align: center; margin-top: 30px;">
                        <button class="btn btn-secondary" onclick="previousStep(3)">‚Üê Previous</button>
                        <button class="btn btn-primary" onclick="completeOnboarding()" id="complete-onboarding-btn">üéâ Complete Onboarding</button>
                    </div>
                </div>
            </div>

            <!-- Employee Status -->
            <div class="handbook-section hidden" id="employee-status">
                <h3 style="text-align: center; color: #2e7d32; margin-bottom: 20px;">üìã Employment Status</h3>
                <div style="text-align: center;">
                    <div class="status-indicator status-pending" id="status-display">
                        ‚è≥ Awaiting Manager Approval
                    </div>
                    <p style="margin-top: 15px; color: #7f8c8d;">
                        Your onboarding submission is being reviewed by management. You will receive access to SOPs once approved.
                    </p>
                </div>
            </div>

            <!-- SOP Section (Initially Locked) -->
            <div class="sop-locked" id="sop-section">
                <div class="handbook-section">
                    <h2 style="text-align: center; color: #7CB342; margin-bottom: 30px;">üö® Standard Operating Procedures</h2>
                    
                    <!-- Emergency Contacts -->
                    <div class="emergency-contacts">
                        <a href="#" onclick="callEmergency('911')" class="emergency-contact">
                            üö® Emergency 911
                        </a>
                        <a href="#" onclick="callEmergency('Fire Department: 508-555-1234')" class="emergency-contact">
                            üöí Fire Department<br>508-555-1234
                        </a>
                        <a href="#" onclick="callEmergency('Police Department: 508-555-5678')" class="emergency-contact">
                            üëÆ Police Department<br>508-555-5678
                        </a>
                        <a href="#" onclick="callEmergency('Hospital: 508-555-9999')" class="emergency-contact">
                            üè• Hospital<br>508-555-9999
                        </a>
                    </div>

                    <!-- SOP 1: Medical Emergency -->
                    <div class="sop-accordion">
                        <div class="sop-header" onclick="toggleAccordion(this)">
                            <h3>üö® SOP 1: Medical Emergency or Injury</h3>
                            <span class="toggle-icon">‚ñº</span>
                        </div>
                        <div class="sop-content">
                            <div class="sop-body">
                                <div class="names-section">
                                    <h4>üë• People Involved</h4>
                                    <div class="name-input-group">
                                        <div class="name-input">
                                            <label>Injured Person</label>
                                            <input type="text" placeholder="Full name" onchange="timestampField(this)">
                                        </div>
                                        <div class="name-input">
                                            <label>Witness 1</label>
                                            <input type="text" placeholder="Full name" onchange="timestampField(this)">
                                        </div>
                                        <div class="name-input">
                                            <label>First Responder</label>
                                            <input type="text" placeholder="EMS/Fire personnel name" onchange="timestampField(this)">
                                        </div>
                                        <div class="name-input">
                                            <label>Incident Severity</label>
                                            <select onchange="timestampField(this)">
                                                <option value="">Select Severity</option>
                                                <option value="minor">Minor Injury</option>
                                                <option value="moderate">Moderate Injury</option>
                                                <option value="severe">Severe/Critical</option>
                                                <option value="life-threatening">Life Threatening</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="incident-media">
                                    <h4>üì∏ Incident Documentation</h4>
                                    <div class="media-controls">
                                        <button class="btn btn-primary" onclick="demoTakePhoto()">üì∑ Take Photo</button>
                                        <button class="btn btn-primary" onclick="demoRecordAudio()">üé§ Record Audio</button>
                                        <button class="btn btn-primary" onclick="demoUploadDocument()">üìÑ Upload Document</button>
                                        <button class="btn btn-emergency" onclick="demoNotifyManagement()">üö® Notify Management</button>
                                    </div>
                                    <div class="media-preview" id="sop1-media-preview"></div>
                                </div>
                                <div class="completion-status">Progress: <span class="progress-text">0/8 completed</span></div>
                                <div class="progress-bar"><div class="progress-fill"></div></div>
                                
                                <div class="checklist-item">
                                    <input type="checkbox" onchange="updateProgress(this)">
                                    <div class="checklist-text">‚úÖ Check the scene for safety. Do not enter unsafe areas.</div>
                                    <div class="item-timestamp"></div>
                                </div>
                                <div class="checklist-item">
                                    <input type="checkbox" onchange="updateProgress(this)">
                                    <div class="checklist-text">üö® <strong>Call 911 immediately if:</strong> Person is unconscious, bleeding heavily, not breathing, suspected head/neck/spinal injury, chest pain, seizure, or possible stroke.</div>
                                    <div class="item-timestamp"></div>
                                </div>
                                <div class="checklist-item">
                                    <input type="checkbox" onchange="updateProgress(this)">
                                    <div class="checklist-text">ü©π Provide basic aid if you are certified and it's safe to do so.</div>
                                    <div class="item-timestamp"></div>
                                </div>
                                <div class="checklist-item">
                                    <input type="checkbox" onchange="updateProgress(this)">
                                    <div class="checklist-text">üõë Keep the guest still and calm. Do not allow them to walk or move if injured.</div>
                                    <div class="item-timestamp"></div>
                                </div>
                                <div class="checklist-item">
                                    <input type="checkbox" onchange="updateProgress(this)">
                                    <div class="checklist-text">üèÉ Send another staff or volunteer to direct EMS to the location.</div>
                                    <div class="item-timestamp"></div>
                                </div>
                                <div class="checklist-item">
                                    <input type="checkbox" onchange="updateProgress(this)">
                                    <div class="checklist-text">üìû Notify the GM and begin completing the Incident Report.</div>
                                    <div class="item-timestamp"></div>
                                </div>
                                <div class="checklist-item">
                                    <input type="checkbox" onchange="updateProgress(this)">
                                    <div class="checklist-text">üè• If injury is minor and does not require EMS: Offer first aid if certified, complete Incident Report, monitor guest.</div>
                                    <div class="item-timestamp"></div>
                                </div>
                                <div class="checklist-item">
                                    <input type="checkbox" onchange="updateProgress(this)">
                                    <div class="checklist-text">üßΩ Clean and disinfect any biohazard (blood, vomit, etc.) only after report is complete and safe to do so.</div>
                                    <div class="item-timestamp"></div>
                                </div>

                                <div class="sop-signature-section">
                                    <h4>‚úçÔ∏è Employee Signature - Medical Emergency SOP</h4>
                                    <canvas class="mini-canvas" data-sop="sop1"></canvas>
                                    <div class="mini-controls">
                                        <button class="btn btn-secondary btn-small" onclick="clearMiniSignature(this)">Clear</button>
                                        <button class="btn btn-primary btn-small" onclick="saveMiniSignature(this)">Save Signature</button>
                                    </div>
                                    <div class="timestamp" id="sop1-timestamp"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SOP 2: Criminal Incident -->
                    <div class="sop-accordion">
                        <div class="sop-header" onclick="toggleAccordion(this)">
                            <h3>üö® SOP 2: Criminal Incident (Assault, Theft, Harassment, Vandalism)</h3>
                            <span class="toggle-icon">‚ñº</span>
                        </div>
                        <div class="sop-content">
                            <div class="sop-body">
                                <div class="incident-media">
                                    <h4>üì∏ Incident Documentation</h4>
                                    <div class="media-controls">
                                        <button class="btn btn-primary" onclick="demoTakePhoto()">üì∑ Take Photo</button>
                                        <button class="btn btn-primary" onclick="demoRecordAudio()">üé§ Record Audio</button>
                                        <button class="btn btn-primary" onclick="demoUploadDocument()">üìÑ Upload Document</button>
                                        <button class="btn btn-emergency" onclick="demoNotifyManagement()">üö® Notify Management</button>
                                    </div>
                                    <div class="media-preview" id="sop2-media-preview"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SOP 3: Vehicle Accident -->
                    <div class="sop-accordion">
                        <div class="sop-header" onclick="toggleAccordion(this)">
                            <h3>üöó SOP 3: Vehicle Accident or Property Damage</h3>
                            <span class="toggle-icon">‚ñº</span>
                        </div>
                        <div class="sop-content">
                            <div class="sop-body">
                                <div class="incident-media">
                                    <h4>üì∏ Incident Documentation</h4>
                                    <div class="media-controls">
                                        <button class="btn btn-primary" onclick="demoTakePhoto()">üì∑ Take Photo</button>
                                        <button class="btn btn-primary" onclick="demoRecordAudio()">üé§ Record Audio</button>
                                        <button class="btn btn-primary" onclick="demoUploadDocument()">üìÑ Upload Document</button>
                                        <button class="btn btn-emergency" onclick="demoNotifyManagement()">üö® Notify Management</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SOP 4: Missing Person -->
                    <div class="sop-accordion">
                        <div class="sop-header" onclick="toggleAccordion(this)">
                            <h3>üë§ SOP 4: Missing Person (Adult or Child)</h3>
                            <span class="toggle-icon">‚ñº</span>
                        </div>
                        <div class="sop-content">
                            <div class="sop-body">
                                <div class="incident-media">
                                    <h4>üì∏ Incident Documentation</h4>
                                    <div class="media-controls">
                                        <button class="btn btn-primary" onclick="demoTakePhoto()">üì∑ Take Photo</button>
                                        <button class="btn btn-primary" onclick="demoRecordAudio()">üé§ Record Audio</button>
                                        <button class="btn btn-primary" onclick="demoUploadDocument()">üìÑ Upload Document</button>
                                        <button class="btn btn-emergency" onclick="demoNotifyManagement()">üö® Notify Management</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SOP 5: Disturbances -->
                    <div class="sop-accordion">
                        <div class="sop-header" onclick="toggleAccordion(this)">
                            <h3>üîä SOP 5: Disturbances (Fights, Noise, Intoxication)</h3>
                            <span class="toggle-icon">‚ñº</span>
                        </div>
                        <div class="sop-content">
                            <div class="sop-body">
                                <div class="incident-media">
                                    <h4>üì∏ Incident Documentation</h4>
                                    <div class="media-controls">
                                        <button class="btn btn-primary" onclick="demoTakePhoto()">üì∑ Take Photo</button>
                                        <button class="btn btn-primary" onclick="demoRecordAudio()">üé§ Record Audio</button>
                                        <button class="btn btn-primary" onclick="demoUploadDocument()">üìÑ Upload Document</button>
                                        <button class="btn btn-emergency" onclick="demoNotifyManagement()">üö® Notify Management</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SOP 6: Fire Emergency -->
                    <div class="sop-accordion">
                        <div class="sop-header" onclick="toggleAccordion(this)">
                            <h3>üî• SOP 6: Fire, Smoke, or Explosion</h3>
                            <span class="toggle-icon">‚ñº</span>
                        </div>
                        <div class="sop-content">
                            <div class="sop-body">
                                <div class="incident-media">
                                    <h4>üì∏ Incident Documentation</h4>
                                    <div class="media-controls">
                                        <button class="btn btn-primary" onclick="demoTakePhoto()">üì∑ Take Photo</button>
                                        <button class="btn btn-primary" onclick="demoRecordAudio()">üé§ Record Audio</button>
                                        <button class="btn btn-primary" onclick="demoUploadDocument()">üìÑ Upload Document</button>
                                        <button class="btn btn-emergency" onclick="demoNotifyManagement()">üö® Notify Management</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SOP 7: Hazardous Conditions -->
                    <div class="sop-accordion">
                        <div class="sop-header" onclick="toggleAccordion(this)">
                            <h3>‚ö†Ô∏è SOP 7: Hazardous Conditions or Utility Failure</h3>
                            <span class="toggle-icon">‚ñº</span>
                        </div>
                        <div class="sop-content">
                            <div class="sop-body">
                                <div class="incident-media">
                                    <h4>üì∏ Incident Documentation</h4>
                                    <div class="media-controls">
                                        <button class="btn btn-primary" onclick="demoTakePhoto()">üì∑ Take Photo</button>
                                        <button class="btn btn-primary" onclick="demoRecordAudio()">üé§ Record Audio</button>
                                        <button class="btn btn-primary" onclick="demoUploadDocument()">üìÑ Upload Document</button>
                                        <button class="btn btn-emergency" onclick="demoNotifyManagement()">üö® Notify Management</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SOP 8: Sexual Assault -->
                    <div class="sop-accordion">
                        <div class="sop-header" onclick="toggleAccordion(this)">
                            <h3>üö® SOP 8: Sexual Assault or Abuse</h3>
                            <span class="toggle-icon">‚ñº</span>
                        </div>
                        <div class="sop-content">
                            <div class="sop-body">
                                <div class="incident-media">
                                    <h4>üì∏ Incident Documentation</h4>
                                    <div class="media-controls">
                                        <button class="btn btn-primary" onclick="demoTakePhoto()">üì∑ Take Photo</button>
                                        <button class="btn btn-primary" onclick="demoRecordAudio()">üé§ Record Audio</button>
                                        <button class="btn btn-primary" onclick="demoUploadDocument()">üìÑ Upload Document</button>
                                        <button class="btn btn-emergency" onclick="demoNotifyManagement()">üö® Notify Management</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SOP 9: Severe Weather -->
                    <div class="sop-accordion">
                        <div class="sop-header" onclick="toggleAccordion(this)">
                            <h3>üå™Ô∏è SOP 9: Severe Weather or Natural Disaster</h3>
                            <span class="toggle-icon">‚ñº</span>
                        </div>
                        <div class="sop-content">
                            <div class="sop-body">
                                <div class="incident-media">
                                    <h4>üì∏ Incident Documentation</h4>
                                    <div class="media-controls">
                                        <button class="btn btn-primary" onclick="demoTakePhoto()">üì∑ Take Photo</button>
                                        <button class="btn btn-primary" onclick="demoRecordAudio()">üé§ Record Audio</button>
                                        <button class="btn btn-primary" onclick="demoUploadDocument()">üìÑ Upload Document</button>
                                        <button class="btn btn-emergency" onclick="demoNotifyManagement()">üö® Notify Management</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SOP 10: Death on Property -->
                    <div class="sop-accordion">
                        <div class="sop-header" onclick="toggleAccordion(this)">
                            <h3>üíÄ SOP 10: Death on Property</h3>
                            <span class="toggle-icon">‚ñº</span>
                        </div>
                        <div class="sop-content">
                            <div class="sop-body">
                                <div class="incident-media">
                                    <h4>üì∏ Incident Documentation</h4>
                                    <div class="media-controls">
                                        <button class="btn btn-primary" onclick="demoTakePhoto()">üì∑ Take Photo</button>
                                        <button class="btn btn-primary" onclick="demoRecordAudio()">üé§ Record Audio</button>
                                        <button class="btn btn-primary" onclick="demoUploadDocument()">üìÑ Upload Document</button>
                                        <button class="btn btn-emergency" onclick="demoNotifyManagement()">üö® Notify Management</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Manager Dashboard Tab -->
        <div id="manager-tab" class="tab-content">
            <div class="handbook-section">
                <h2 style="text-align: center; color: #2e7d32; margin-bottom: 30px;">üëî Manager Dashboard</h2>
                
                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <h3>üìã Pending Approvals</h3>
                        <div id="pending-employees">
                            <!-- Pending employee cards will be populated here -->
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <h3>‚úÖ Active Employees</h3>
                        <div id="active-employees">
                            <!-- Active employee cards will be populated here -->
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <h3>üö® Recent Incidents</h3>
                        <div id="recent-incidents">
                            <!-- Recent incidents will be listed here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Owner Dashboard Tab -->
        <div id="owner-tab" class="tab-content">
            <div class="handbook-section">
                <h2 style="text-align: center; color: #2e7d32; margin-bottom: 30px;">üè¢ Owner Dashboard</h2>
                
                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <h3>üìä System Overview</h3>
                        <div id="system-stats">
                            <!-- System statistics will be populated here -->
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <h3>üë• All Employees</h3>
                        <div id="all-employees">
                            <!-- All employees will be listed here -->
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <h3>üìà Reports & Analytics</h3>
                        <div id="reports-analytics">
                            <!-- Reports and analytics will be shown here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Hidden elements for media capture -->
    <input type="file" id="incident-photo-input" accept="image/*" class="hidden" onchange="handleIncidentPhoto(event)">
    <input type="file" id="document-input" accept=".pdf,.doc,.docx,.txt" class="hidden" onchange="handleDocumentUpload(event)">

    <script>
        // Global variables
        let currentStep = 1;
        let employeePhoto = null;
        let handbookSigned = false;
        let currentUser = null;

        // Firebase configuration (you would replace with your actual config)
        const firebaseConfig = {
            // Your Firebase configuration would go here
        };

        // Initialize Firebase (commented out for demo)
        // import { initializeApp } from 'firebase/app';
        // import { getFirestore, collection, addDoc, updateDoc, onSnapshot } from 'firebase/firestore';
        // import { getStorage, ref, uploadBytes, getDownloadURL } from 'firebase/storage';

        // Demo employee photo function that immediately unlocks SOPs
        function demoTakeEmployeePhoto() {
            // Simulate photo capture
            const placeholder = document.getElementById('photo-placeholder');
            const preview = document.getElementById('photo-preview');
            
            // Create demo photo
            const canvas = document.createElement('canvas');
            canvas.width = 200;
            canvas.height = 200;
            const ctx = canvas.getContext('2d');
            
            // Draw a simple employee photo simulation
            ctx.fillStyle = '#7CB342';
            ctx.fillRect(0, 0, 200, 200);
            ctx.fillStyle = 'white';
            ctx.font = 'bold 24px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('üì∑', 100, 80);
            ctx.fillText('Employee', 100, 120);
            ctx.fillText('Photo', 100, 150);
            ctx.font = '12px Arial';
            ctx.fillText(new Date().toLocaleString(), 100, 180);
            
            const photoData = canvas.toDataURL();
            
            // Display the photo
            preview.src = photoData;
            preview.classList.remove('hidden');
            placeholder.classList.add('hidden');
            
            // Enable next button
            document.getElementById('photo-next-btn').disabled = false;
            
            // Store photo data
            window.employeePhoto = photoData;
            
            // IMMEDIATELY UNLOCK SOPs FOR DEMO
            document.getElementById('sop-section').classList.remove('sop-locked');
            
            // Show big success notification
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                padding: 30px 50px;
                background: linear-gradient(45deg, #7CB342, #8BC34A);
                color: white;
                font-size: 1.5em;
                font-weight: bold;
                border-radius: 15px;
                z-index: 1000;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
                text-align: center;
            `;
            notification.innerHTML = 'üéâ OPERATING SOPs NOW AVAILABLE! üéâ<br><br>‚úÖ Photo Captured<br>‚úÖ SOPs Unlocked<br>‚úÖ Ready for Training';
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 4000);
        }

        // Add mini signature functionality
        function clearMiniSignature(button) {
            const canvas = button.parentElement.previousElementSibling;
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function saveMiniSignature(button) {
            const canvas = button.parentElement.previousElementSibling;
            const sopId = canvas.dataset.sop;
            const timestampDiv = document.getElementById(sopId + '-timestamp');
            
            // Show demo signature save
            const employeeName = document.getElementById('employeeName').value || 'Demo Employee';
            const timestamp = new Date().toLocaleString();
            timestampDiv.innerHTML = `<strong>Signed by:</strong> ${employeeName}<br><strong>Date:</strong> ${timestamp}`;
            
            showNotification(`‚úÖ SOP signature saved successfully!`, 'success');
        }

        // Setup mini canvases when page loads
        function setupMiniCanvases() {
            document.querySelectorAll('.mini-canvas').forEach(canvas => {
                const ctx = canvas.getContext('2d');
                let isDrawing = false;

                canvas.width = canvas.offsetWidth;
                canvas.height = canvas.offsetHeight;

                function startDrawing(e) {
                    isDrawing = true;
                    const rect = canvas.getBoundingClientRect();
                    ctx.beginPath();
                    const x = (e.clientX || e.touches[0].clientX) - rect.left;
                    const y = (e.clientY || e.touches[0].clientY) - rect.top;
                    ctx.moveTo(x, y);
                }

                function draw(e) {
                    if (!isDrawing) return;
                    e.preventDefault();
                    const rect = canvas.getBoundingClientRect();
                    ctx.lineWidth = 2;
                    ctx.lineCap = 'round';
                    ctx.strokeStyle = '#7CB342';
                    const x = (e.clientX || e.touches[0].clientX) - rect.left;
                    const y = (e.clientY || e.touches[0].clientY) - rect.top;
                    ctx.lineTo(x, y);
                    ctx.stroke();
                }

                function stopDrawing() {
                    isDrawing = false;
                }

                canvas.addEventListener('mousedown', startDrawing);
                canvas.addEventListener('mousemove', draw);
                canvas.addEventListener('mouseup', stopDrawing);
                canvas.addEventListener('touchstart', startDrawing);
                canvas.addEventListener('touchmove', draw);
                canvas.addEventListener('touchend', stopDrawing);
            });
        }

        // Timestamp field function
        function timestampField(input) {
            if (input.value.trim() !== '') {
                let timestampDiv = input.parentElement.querySelector('.timestamp-badge');
                if (!timestampDiv) {
                    timestampDiv = document.createElement('div');
                    timestampDiv.className = 'timestamp-badge';
                    input.parentElement.appendChild(timestampDiv);
                }
                const now = new Date();
                timestampDiv.textContent = `Entered: ${now.toLocaleString()}`;
                
                // Show notification for demo
                showNotification(`üìù Field updated: ${input.placeholder || 'Data entered'}`, 'success');
            }
        }
        function completeOnboarding() {
            if (!validateSignature()) {
                alert('Please provide your signature to complete onboarding.');
                return;
            }

            const employeeName = document.getElementById('employeeName').value;
            if (!employeeName) {
                alert('Please complete employee information first.');
                return;
            }

            // Complete onboarding
            document.getElementById('onboarding-wizard').classList.add('hidden');
            document.getElementById('employee-status').classList.remove('hidden');
            
            // Unlock SOPs immediately since this is a demo
            setTimeout(() => {
                document.getElementById('sop-section').classList.remove('sop-locked');
                document.getElementById('status-display').className = 'status-indicator status-approved';
                document.getElementById('status-display').innerHTML = '‚úÖ Approved - SOPs Unlocked';
                
                showNotification('üéâ Onboarding Complete! SOPs are now accessible.', 'success');
            }, 2000);

            const timestamp = new Date().toLocaleString();
            document.getElementById('signature-timestamp').innerHTML = 
                `<strong>Training Completed:</strong> ${timestamp}<br><strong>Employee:</strong> ${employeeName}`;
        }

        // Onboarding wizard functions
        let currentStep = 1;
        
        function nextStep(step) {
            if (validateCurrentStep()) {
                document.getElementById(`wizard-step-${currentStep}`).classList.remove('active');
                document.getElementById(`step-${currentStep}`).classList.add('completed');
                document.getElementById(`step-${currentStep}`).classList.remove('active');
                
                currentStep = step;
                document.getElementById(`wizard-step-${step}`).classList.add('active');
                document.getElementById(`step-${step}`).classList.add('active');
            }
        }

        function previousStep(step) {
            document.getElementById(`wizard-step-${currentStep}`).classList.remove('active');
            document.getElementById(`step-${currentStep}`).classList.remove('active');
            
            if (currentStep > 1) {
                document.getElementById(`step-${currentStep - 1}`).classList.remove('completed');
            }
            
            currentStep = step;
            document.getElementById(`wizard-step-${step}`).classList.add('active');
            document.getElementById(`step-${step}`).classList.add('active');
        }

        function validateCurrentStep() {
            switch(currentStep) {
                case 1:
                    return validateEmployeeInfo();
                case 2:
                    return window.employeePhoto !== undefined;
                case 3:
                    return document.getElementById('handbook-acknowledgment').checked;
                case 4:
                    return validateSignature();
                default:
                    return true;
            }
        }

        function validateEmployeeInfo() {
            const required = ['employeeName', 'employeeId', 'employeeEmail', 'employeePhone', 'employeePosition', 'startDate'];
            return required.every(id => document.getElementById(id).value.trim() !== '');
        }

        function uploadPhoto() {
            document.getElementById('file-input').click();
        }

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    window.employeePhoto = e.target.result;
                    displayPhoto(window.employeePhoto);
                    document.getElementById('photo-next-btn').disabled = false;
                };
                reader.readAsDataURL(file);
            }
        }

        function displayPhoto(photoData) {
            const preview = document.getElementById('photo-preview');
            preview.src = photoData;
            preview.classList.remove('hidden');
            document.getElementById('photo-placeholder').classList.add('hidden');
        }

        function toggleHandbookNext() {
            const checkbox = document.getElementById('handbook-acknowledgment');
            const nextBtn = document.getElementById('handbook-next-btn');
            nextBtn.disabled = !checkbox.checked;
        }

        function validateSignature() {
            const canvas = document.getElementById('handbook-signature');
            const imgData = canvas.toDataURL();
            const blankCanvas = document.createElement('canvas');
            blankCanvas.width = canvas.width;
            blankCanvas.height = canvas.height;
            const blankData = blankCanvas.toDataURL();
            return imgData !== blankData;
        }

        function clearSignature(canvasId) {
            const canvas = document.getElementById(canvasId);
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }
        function demoTakePhoto() {
            const preview = event.target.closest('.sop-body').querySelector('.media-preview');
            const photoDiv = document.createElement('div');
            photoDiv.className = 'media-item';
            photoDiv.innerHTML = `
                <div style="width: 100px; height: 100px; background: linear-gradient(45deg, #7CB342, #8BC34A); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">
                    üì∑<br>Photo<br>${new Date().toLocaleTimeString()}
                </div>
                <button class="remove-btn" onclick="removeMedia(this)">√ó</button>
            `;
            preview.appendChild(photoDiv);
            
            // Show success message
            showNotification('üì∑ Photo captured successfully!', 'success');
        }

        function demoRecordAudio() {
            const preview = event.target.closest('.sop-body').querySelector('.media-preview');
            const audioDiv = document.createElement('div');
            audioDiv.className = 'media-item';
            audioDiv.innerHTML = `
                <div style="width: 100px; height: 100px; background: linear-gradient(45deg, #FF9800, #F57C00); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">
                    üé§<br>Audio<br>${new Date().toLocaleTimeString()}
                </div>
                <button class="remove-btn" onclick="removeMedia(this)">√ó</button>
            `;
            preview.appendChild(audioDiv);
            
            showNotification('üé§ Audio recorded successfully!', 'success');
        }

        function demoUploadDocument() {
            const preview = event.target.closest('.sop-body').querySelector('.media-preview');
            const docDiv = document.createElement('div');
            docDiv.className = 'media-item';
            docDiv.innerHTML = `
                <div style="width: 100px; height: 100px; background: linear-gradient(45deg, #2196F3, #1976D2); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">
                    üìÑ<br>Document<br>${new Date().toLocaleTimeString()}
                </div>
                <button class="remove-btn" onclick="removeMedia(this)">√ó</button>
            `;
            preview.appendChild(docDiv);
            
            showNotification('üìÑ Document uploaded successfully!', 'success');
        }

        function demoNotifyManagement() {
            showNotification('üö® ALERT: Management has been notified immediately!', 'emergency');
            
            // Simulate notification popup
            setTimeout(() => {
                alert('üì± EMERGENCY NOTIFICATION SENT:\n\n‚úÖ Manager alerted via SMS\n‚úÖ Owner notified via email\n‚úÖ Incident logged in system\n‚úÖ Emergency response activated');
            }, 500);
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 25px;
                border-radius: 8px;
                color: white;
                font-weight: bold;
                z-index: 1000;
                animation: slideIn 0.3s ease;
                ${type === 'emergency' ? 'background: linear-gradient(45deg, #f44336, #d32f2f);' : 'background: linear-gradient(45deg, #7CB342, #8BC34A);'}
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Make emergency contacts work
        function callEmergency(number) {
            if (number === '911') {
                alert('üö® CALLING 911 EMERGENCY SERVICES\n\nThis would dial emergency services in a real scenario.');
            } else {
                alert(`üìû CALLING: ${number}\n\nThis would dial the number in a real scenario.`);
            }
        }
        function ownerBypass() {
            // Double-click bypass for owner access to SOPs
            document.getElementById('sop-section').classList.remove('sop-locked');
            document.getElementById('employee-status').classList.add('hidden');
            alert('üîì Owner bypass activated! All SOPs are now accessible.');
        }
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all nav tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
        }

        // Onboarding wizard functions
        function nextStep(step) {
            if (validateCurrentStep()) {
                document.getElementById(`wizard-step-${currentStep}`).classList.remove('active');
                document.getElementById(`step-${currentStep}`).classList.add('completed');
                document.getElementById(`step-${currentStep}`).classList.remove('active');
                
                currentStep = step;
                document.getElementById(`wizard-step-${step}`).classList.add('active');
                document.getElementById(`step-${step}`).classList.add('active');
            }
        }

        function previousStep(step) {
            document.getElementById(`wizard-step-${currentStep}`).classList.remove('active');
            document.getElementById(`step-${currentStep}`).classList.remove('active');
            
            if (currentStep > 1) {
                document.getElementById(`step-${currentStep - 1}`).classList.remove('completed');
            }
            
            currentStep = step;
            document.getElementById(`wizard-step-${step}`).classList.add('active');
            document.getElementById(`step-${step}`).classList.add('active');
        }

        function validateCurrentStep() {
            switch(currentStep) {
                case 1:
                    return validateEmployeeInfo();
                case 2:
                    return employeePhoto !== null;
                case 3:
                    return document.getElementById('handbook-acknowledgment').checked;
                case 4:
                    return validateSignature();
                default:
                    return true;
            }
        }

        function validateEmployeeInfo() {
            const required = ['employeeName', 'employeeId', 'employeeEmail', 'employeePhone', 'employeePosition', 'startDate'];
            return required.every(id => document.getElementById(id).value.trim() !== '');
        }

        // Photo capture functions
        function startCamera() {
            navigator.mediaDevices.getUserMedia({ video: true })
                .then(stream => {
                    const video = document.getElementById('video');
                    video.srcObject = stream;
                    video.classList.remove('hidden');
                    document.getElementById('capture-btn').classList.remove('hidden');
                    document.getElementById('photo-placeholder').classList.add('hidden');
                })
                .catch(err => {
                    console.error('Camera access denied:', err);
                    alert('Camera access is required for employee photo. Please allow camera access or upload a photo instead.');
                });
        }

        function capturePhoto() {
            const video = document.getElementById('video');
            const canvas = document.createElement('canvas');
            canvas.width = 200;
            canvas.height = 200;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(video, 0, 0, 200, 200);
            
            employeePhoto = canvas.toDataURL('image/jpeg', 0.8);
            displayPhoto(employeePhoto);
            
            // Stop camera
            const stream = video.srcObject;
            const tracks = stream.getTracks();
            tracks.forEach(track => track.stop());
            video.classList.add('hidden');
            document.getElementById('capture-btn').classList.add('hidden');
            document.getElementById('photo-next-btn').disabled = false;
        }

        function uploadPhoto() {
            document.getElementById('file-input').click();
        }

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    employeePhoto = e.target.result;
                    displayPhoto(employeePhoto);
                    document.getElementById('photo-next-btn').disabled = false;
                };
                reader.readAsDataURL(file);
            }
        }

        function displayPhoto(photoData) {
            const preview = document.getElementById('photo-preview');
            preview.src = photoData;
            preview.classList.remove('hidden');
            document.getElementById('photo-placeholder').classList.add('hidden');
        }

        // Handbook functions
        function toggleHandbookNext() {
            const checkbox = document.getElementById('handbook-acknowledgment');
            const nextBtn = document.getElementById('handbook-next-btn');
            nextBtn.disabled = !checkbox.checked;
        }

        // Signature functions
        function setupSignatureCanvas(canvasId) {
            const canvas = document.getElementById(canvasId);
            const ctx = canvas.getContext('2d');
            let isDrawing = false;

            function resizeCanvas() {
                const rect = canvas.getBoundingClientRect();
                canvas.width = rect.width;
                canvas.height = rect.height;
            }

            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);

            function startDrawing(e) {
                isDrawing = true;
                const rect = canvas.getBoundingClientRect();
                ctx.beginPath();
                const x = (e.clientX || e.touches[0].clientX) - rect.left;
                const y = (e.clientY || e.touches[0].clientY) - rect.top;
                ctx.moveTo(x, y);
            }

            function draw(e) {
                if (!isDrawing) return;
                e.preventDefault();
                const rect = canvas.getBoundingClientRect();
                ctx.lineWidth = 2;
                ctx.lineCap = 'round';
                ctx.strokeStyle = '#006400';
                const x = (e.clientX || e.touches[0].clientX) - rect.left;
                const y = (e.clientY || e.touches[0].clientY) - rect.top;
                ctx.lineTo(x, y);
                ctx.stroke();
            }

            function stopDrawing() {
                isDrawing = false;
            }

            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('touchstart', startDrawing);
            canvas.addEventListener('touchmove', draw);
            canvas.addEventListener('touchend', stopDrawing);
        }

        function clearSignature(canvasId) {
            const canvas = document.getElementById(canvasId);
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function validateSignature() {
            const canvas = document.getElementById('handbook-signature');
            const imgData = canvas.toDataURL();
            const blankCanvas = document.createElement('canvas');
            blankCanvas.width = canvas.width;
            blankCanvas.height = canvas.height;
            const blankData = blankCanvas.toDataURL();
            return imgData !== blankData;
        }

        // Complete onboarding
        async function completeOnboarding() {
            if (!validateSignature()) {
                alert('Please provide your signature to complete onboarding.');
                return;
            }

            const employeeData = {
                name: document.getElementById('employeeName').value,
                id: document.getElementById('employeeId').value,
                email: document.getElementById('employeeEmail').value,
                phone: document.getElementById('employeePhone').value,
                position: document.getElementById('employeePosition').value,
                startDate: document.getElementById('startDate').value,
                supervisor: document.getElementById('supervisorName').value,
                emergencyContact: document.getElementById('emergencyContact').value,
                photo: employeePhoto,
                signature: document.getElementById('handbook-signature').toDataURL(),
                handbookSignedAt: new Date().toISOString(),
                status: 'pending'
            };

            // Save to Firebase (would be implemented with actual Firebase)
            console.log('Saving employee data:', employeeData);
            
            // Show status page
            document.getElementById('onboarding-wizard').classList.add('hidden');
            document.getElementById('employee-status').classList.remove('hidden');
            
            // Add timestamp
            document.getElementById('signature-timestamp').textContent = 
                `Signed on: ${new Date().toLocaleString()}`;

            alert('üéâ Onboarding completed! Your submission is pending manager approval.');
        }

        // Incident reporting functions
        function captureIncidentPhoto() {
            document.getElementById('incident-photo-input').click();
        }

        function handleIncidentPhoto(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    addMediaToPreview(e.target.result, 'photo');
                    // Save to Firebase
                    saveIncidentMedia(e.target.result, 'photo');
                };
                reader.readAsDataURL(file);
            }
        }

        function recordAudio() {
            if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                navigator.mediaDevices.getUserMedia({ audio: true })
                    .then(stream => {
                        const mediaRecorder = new MediaRecorder(stream);
                        const audioChunks = [];

                        mediaRecorder.addEventListener('dataavailable', event => {
                            audioChunks.push(event.data);
                        });

                        mediaRecorder.addEventListener('stop', () => {
                            const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
                            const audioUrl = URL.createObjectURL(audioBlob);
                            addMediaToPreview(audioUrl, 'audio');
                            saveIncidentMedia(audioBlob, 'audio');
                        });

                        mediaRecorder.start();
                        
                        // Stop recording after 30 seconds or on user action
                        setTimeout(() => {
                            mediaRecorder.stop();
                            stream.getTracks().forEach(track => track.stop());
                        }, 30000);

                        alert('Recording started. Recording will stop automatically in 30 seconds.');
                    })
                    .catch(err => {
                        console.error('Microphone access denied:', err);
                        alert('Microphone access is required for audio recording.');
                    });
            }
        }

        function uploadDocument() {
            document.getElementById('document-input').click();
        }

        function handleDocumentUpload(event) {
            const file = event.target.files[0];
            if (file) {
                addMediaToPreview(file.name, 'document');
                saveIncidentMedia(file, 'document');
            }
        }

        function addMediaToPreview(src, type) {
            const preview = document.getElementById('incident-media-preview');
            const mediaItem = document.createElement('div');
            mediaItem.className = 'media-item';
            
            if (type === 'photo') {
                mediaItem.innerHTML = `
                    <img src="${src}" alt="Incident Photo">
                    <button class="remove-btn" onclick="removeMedia(this)">√ó</button>
                `;
            } else if (type === 'audio') {
                mediaItem.innerHTML = `
                    <audio controls src="${src}"></audio>
                    <button class="remove-btn" onclick="removeMedia(this)">√ó</button>
                `;
            } else if (type === 'document') {
                mediaItem.innerHTML = `
                    <div style="padding: 10px; background: #ecf0f1; text-align: center;">
                        üìÑ ${src}
                    </div>
                    <button class="remove-btn" onclick="removeMedia(this)">√ó</button>
                `;
            }
            
            preview.appendChild(mediaItem);
        }

        function removeMedia(button) {
            button.parentElement.remove();
        }

        function saveIncidentMedia(data, type) {
            // Save to Firebase Storage
            console.log(`Saving ${type} to Firebase:`, data);
            // Implement Firebase Storage upload
        }

        function notifyManagement() {
            // Send real-time notification to managers
            console.log('Notifying management of incident');
            alert('üö® Management has been notified of this incident!');
            
            // In real implementation, this would:
            // - Send push notification to managers
            // - Create incident record in Firebase
            // - Trigger email/SMS alerts
        }

        function toggleAccordion(header) {
            const content = header.nextElementSibling;
            const icon = header.querySelector('.toggle-icon');
            
            header.classList.toggle('active');
            content.classList.toggle('active');
            
            if (content.classList.contains('active')) {
                content.style.maxHeight = content.scrollHeight + 'px';
            } else {
                content.style.maxHeight = '0';
            }
        }

        // Manager functions
        function approveEmployee(employeeId) {
            // Update employee status in Firebase
            console.log('Approving employee:', employeeId);
            
            // Unlock SOPs for employee
            if (currentUser && currentUser.id === employeeId) {
                document.getElementById('sop-section').classList.remove('sop-locked');
                document.getElementById('status-display').className = 'status-indicator status-approved';
                document.getElementById('status-display').innerHTML = '‚úÖ Approved - SOPs Unlocked';
            }
            
            alert('Employee approved! SOPs are now accessible.');
        }

        function rejectEmployee(employeeId) {
            console.log('Rejecting employee:', employeeId);
            alert('Employee rejected. They will need to complete onboarding again.');
        }

        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            setupSignatureCanvas('handbook-signature');
            setupMiniCanvases();
            
            // Set default date
            document.getElementById('startDate').valueAsDate = new Date();
            
            // Initialize progress tracking
            updateOverallProgress();
            
            console.log('Douglas Forest RV Employee Management System initialized');
        });

        // Signature canvas setup
        function setupSignatureCanvas(canvasId) {
            const canvas = document.getElementById(canvasId);
            const ctx = canvas.getContext('2d');
            let isDrawing = false;

            function resizeCanvas() {
                const rect = canvas.getBoundingClientRect();
                canvas.width = rect.width;
                canvas.height = rect.height;
            }

            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);

            function startDrawing(e) {
                isDrawing = true;
                const rect = canvas.getBoundingClientRect();
                ctx.beginPath();
                const x = (e.clientX || e.touches[0].clientX) - rect.left;
                const y = (e.clientY || e.touches[0].clientY) - rect.top;
                ctx.moveTo(x, y);
            }

            function draw(e) {
                if (!isDrawing) return;
                e.preventDefault();
                const rect = canvas.getBoundingClientRect();
                ctx.lineWidth = 2;
                ctx.lineCap = 'round';
                ctx.strokeStyle = '#7CB342';
                const x = (e.clientX || e.touches[0].clientX) - rect.left;
                const y = (e.clientY || e.touches[0].clientY) - rect.top;
                ctx.lineTo(x, y);
                ctx.stroke();
            }

            function stopDrawing() {
                isDrawing = false;
            }

            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('touchstart', startDrawing);
            canvas.addEventListener('touchmove', draw);
            canvas.addEventListener('touchend', stopDrawing);
        }
        document.addEventListener('DOMContentLoaded', function() {
            setupSignatureCanvas('handbook-signature');
            
            // Set default date
            document.getElementById('startDate').valueAsDate = new Date();
            
            // Initialize Firebase listeners (would be implemented)
            // setupFirebaseListeners();
            
            console.log('Douglas Forest RV Employee Management System initialized');
        });

        // Simulate manager approval for demo
        function simulateApproval() {
            setTimeout(() => {
                approveEmployee('demo-user');
            }, 5000);
        }
    </script>
</body>
</html>